library(readxl)
library(collapsibleTree)

# Read dataset (not used in the example but you can integrate later)
mathare_1 <- read_excel("~/Documents/mathare.xlsx")

# Define cascade data, making sure all columns have the same length
mathare <- data.frame(
  Level1 = rep("Total Facility workload= 2416", 13),
  Level2 = rep("Screened for R. conditions=2332(98%)", 13),
  Level3 = rep("Total with R. Conditions + High Risk=298", 13),
  Level4 = rep("Total screened with CXR=298", 13),
  Level5 = c(
    "Suggestive TB=78", "Suggestive TB=78",
    "Abnormal CXR Other=68", "Abnormal CXR Other=68", "Abnormal CXR Other=68", "Abnormal CXR Other=68",
    "Lung Nodules=2", "Normal CXR=150",
    rep(NA, 5)
  ),
  Level6 = c(
    "mWRD_Microscopy investigation", "mWRD_Microscopy investigation",
    "Spirometer Done=68", "Spirometer Done=68", "Spirometer Done=68", "Spirometer Done=68",
    NA, NA,
    rep(NA, 5)
  ),
  Level7 = c(
    "MTB Positive=10(13.1%)", "MTB Negative=66",
    "Normal Spirometry=21", "Restrictive=18",
    "Obstructive=27", "Obstructive=27", "Obstructive=27","Obstructive=27","Mixed=2",
    NA, NA, NA, NA
  ),
  Level8 = c(
    NA, "CD=4",
    NA, NA,
    "Asthma=13", "COPD=4", "PTLD=5", "Other=5",
    NA, NA, NA, NA, NA
  ),
  stringsAsFactors = FALSE
)

# Create collapsible tree
collapsibleTree(
  mathare,
  hierarchy = c("Level1", "Level2", "Level3", "Level4", "Level5", "Level6", "Level7", "Level8"),
  root = "Mathare Data",
  width = 900,
  height = 800
)
